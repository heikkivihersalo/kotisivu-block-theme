(()=>{"use strict";var e={n:t=>{var a=t&&t.__esModule?()=>t.default:()=>t;return e.d(a,{a}),a},d:(t,a)=>{for(var r in a)e.o(a,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:a[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,a=window.wp.i18n,r=window.wp.domReady;var i=e.n(r);const l=(0,t.createContext)(null),n=e=>(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",style:{fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:2},viewBox:"0 0 1000 1000","aria-hidden":"true",...e},(0,t.createElement)("path",{d:"M500 0c275.958 0 500 224.042 500 500 0 275.958-224.042 500-500 500C224.042 1000 0 775.958 0 500 0 224.042 224.042 0 500 0Zm264 500L336 209.5v581L764 500Z",style:{fill:"var(--wp--preset--color--primary)"}})),s=e=>(0,t.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",style:{fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:2},viewBox:"0 0 1000 1000","aria-hidden":"true",...e},(0,t.createElement)("path",{d:"M500 0c275.958 0 500 224.042 500 500 0 275.958-224.042 500-500 500C224.042 1000 0 775.958 0 500 0 224.042 224.042 0 500 0Zm-49.799 236H305.522v528h144.679V236Zm244.277 0H549.799v528h144.679V236Z",style:{fill:"var(--wp--preset--color--primary)"}})),m=e=>(0,t.createElement)("svg",{className:"music-playlist__placeholder-image",xmlns:"http://www.w3.org/2000/svg",xmlSpace:"preserve",width:400,height:400,style:{fillRule:"evenodd",clipRule:"evenodd",strokeLinejoin:"round",strokeMiterlimit:2},viewBox:"0 0 400 400",...e},(0,t.createElement)("path",{d:"M0 0h400v400H0z",style:{fill:"#ebebeb"}})),u=({playerRef:e,trackRef:r})=>{const{isPlaying:i,setIsPlaying:u}=(0,t.useContext)(l),[d,c]=(0,t.useState)(0),[o,_]=(0,t.useState)(0);function p(e){const t=Math.floor(e/60),a=e-60*t;return`${t}:${a<10?"0":""}${a}`}return(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"audio-player",tabIndex:"-1","aria-hidden":"true"},(0,t.createElement)("div",{className:"audio-player__info"},(0,t.createElement)("button",{className:"audio-player__btn audio-player__btn--play","data-state":i?"pause":"play",onClick:async function(t){await u(!i);const a=e.current;i?a.pause():a.play()},tabIndex:-1,"aria-hidden":"true"},(0,t.createElement)("span",{className:"is-visually-hidden"},i?(0,a.__)("Pause","kotisivu-block-theme"):(0,a.__)("Play","kotisivu-block-theme")),i?(0,t.createElement)(s,null):(0,t.createElement)(n,null)),(0,t.createElement)("div",{className:"audio-player__track-details"},(0,t.createElement)("div",{className:"audio-player__now-playing"},(0,t.createElement)("h3",null,(0,a.__)("Now Playing","kotisivu-block-theme")),(0,t.createElement)("div",{className:"audio-player__quality"},(0,t.createElement)("span",{className:"audio-player__quality-item"},r.current?.format),(0,t.createElement)("span",{className:"audio-player__quality-item"},r.current?.sampleRate))),(0,t.createElement)("p",{className:"audio-player__track-name"},!r.current?.artist&&(0,a.__)("Loading...","kotisivu-block-theme"),r.current?.artist&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("span",{className:"audio-player__artist"},r.current?.artist),":"," ",(0,t.createElement)("span",{className:"audio-player__album"},r.current?.album)))),r.current?.featuredImage?(0,t.createElement)("img",{className:"audio-player__cover",src:r.current?.featuredImage.src,width:r.current?.featuredImage.width,height:r.current?.featuredImage.height}):(0,t.createElement)(m,null)),(0,t.createElement)("div",{className:"audio-player__timeline"},(0,t.createElement)("div",{className:"audio-player__timeline-elapsed"},(0,t.createElement)("span",{className:"is-visually-hidden"},(0,a.__)("Elapsed Time","kotisivu-block-theme")),p(d)),(0,t.createElement)("label",{htmlFor:"audio-timeline",className:"is-visually-hidden"},(0,a.__)("Timeline","kotisivu-block-theme")),(0,t.createElement)("input",{type:"range",id:"audio-timeline",value:d,min:0,max:o,onChange:async function(t){const a=parseFloat(t.target.value);await c(a),e.current.currentTime=a},"aria-valuetext":`${d} seconds`,tabIndex:-1}),(0,t.createElement)("div",{className:"audio-player__timeline-duration"},(0,t.createElement)("span",{className:"is-visually-hidden"},(0,a.__)("Total Duration","kotisivu-block-theme")),p(o)))),(0,t.createElement)("audio",{className:"is-visually-hidden",controls:!0,ref:e,src:r.current?.src,onLoadedMetadata:async function(){await _(Math.round(e.current.duration))},onTimeUpdate:async function(){await c(Math.round(e.current.currentTime))},onPlay:()=>u(!0),onPause:()=>u(!1)}),(0,t.createElement)("p",{className:"is-visually-hidden"},`${(0,a.__)("Now playing song","kotisivu-block-theme")} ${r.current?.album} ${(0,a.__)("from artist","kotisivu-block-theme")} ${r.current?.artist}`))},d=window.wp.apiFetch;var c=e.n(d);const o=()=>{const[e,r]=(0,t.useState)([]),i=(0,t.useRef)(null),n=(0,t.useRef)(0),s=(0,t.useRef)(null),[d,o]=(0,t.useState)(!1),[_,p]=(0,t.useState)(!1),[,f]=(0,t.useState)(Date.now());async function h(){const t=await e.find(((e,t)=>{if(t===n.current)return e}));i.current={id:n.current,title:t.title.rendered,album:t.media_details?.album,artist:t.media_details?.artist,format:t.media_details?.fileformat,sampleRate:t.media_details?.sample_rate,src:t.source_url,featuredImage:{src:t.metadata?.featured_image?.url,alt:t.metadata?.featured_image?.alt,height:t.metadata?.featured_image?.height,width:t.metadata?.featured_image?.width,title:t.metadata?.featured_image?.title}},await f(Date.now()),document.querySelector('.audio-player__list-item[aria-current="true"]').focus(),d&&(s.current.play(),o(!0))}return(0,t.useEffect)((()=>{(async()=>{let e=await async function(e=null){let t=new URL(window.location.origin+"/wp/v2/media");for(const[a,r]of Object.entries(e))t.searchParams.append(a,r);return await c()({path:t.pathname+t.search}).then((e=>e))}({per_page:25,media_type:"audio"});await r(e),i.current={id:0,title:e[0].title.rendered,album:e[0].media_details?.album,artist:e[0].media_details?.artist,format:e[0].media_details?.fileformat,sampleRate:e[0].media_details?.sample_rate,src:e[0].source_url,featuredImage:{src:e[0].metadata?.featured_image?.url,alt:e[0].metadata?.featured_image?.alt,height:e[0].metadata?.featured_image?.height,width:e[0].metadata?.featured_image?.width,title:e[0].metadata?.featured_image?.title}},p(!1)})()}),[]),(0,t.createElement)(t.Fragment,null,(0,t.createElement)(l.Provider,{value:{isPlaying:d,setIsPlaying:o}},_&&(0,t.createElement)("div",null,(0,a.__)("Loading...","kotisivu-block-theme")),!_&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)(u,{playerRef:s,trackRef:i}),(0,t.createElement)("ol",{className:"audio-player__list","aria-label":(0,a.__)("Playlist","kotisivu-block-theme"),role:"list",onKeyDown:t=>async function(t){const a=s.current,r=parseInt(document.activeElement.dataset.id);switch(t.key){case" ":if(r===n.current)(async()=>{d?(a.pause(),o(!1)):(a.play(),o(!0))})();else{n.current=r;const t=await e.find(((e,t)=>{if(r===t)return e}));i.current={id:n.current,title:t.title.rendered,album:t.media_details?.album,artist:t.media_details?.artist,format:t.media_details?.fileformat,sampleRate:t.media_details?.sample_rate,src:t.source_url,featuredImage:{src:t.metadata?.featured_image?.url,alt:t.metadata?.featured_image?.alt,height:t.metadata?.featured_image?.height,width:t.metadata?.featured_image?.width,title:t.metadata?.featured_image?.title}},await f(Date.now()),s.current.play(),o(!0)}break;case"ArrowDown":"LI"===t.target.tagName&&t.preventDefault(),await(async()=>{n.current===e.length-1?n.current=0:n.current=n.current+1})(),h();break;case"ArrowUp":"LI"===t.target.tagName&&t.preventDefault(),await(async()=>{0===n.current?n.current=e.length-1:n.current=n.current-1})(),h()}await f(Date.now())}(t)},e.map(((r,l)=>{const u={id:l,title:r.title.rendered,album:r.media_details?.album,artist:r.media_details?.artist,format:r.media_details?.fileformat,sampleRate:r.media_details?.sample_rate,src:r.source_url,featuredImage:{src:r.metadata?.featured_image?.url,alt:r.metadata?.featured_image?.alt,height:r.metadata?.featured_image?.height,width:r.metadata?.featured_image?.width,title:r.metadata?.featured_image?.title}};return(0,t.createElement)("li",{key:u.id,className:"audio-player__list-item",role:"listItem",onClick:e=>async function(e,t,a){const r=s.current,l=i.current;if(i.current=a,n.current=t,await f(Date.now()),d&&i.current.id===l.id)return r.pause(),void o(!1);r.play(),o(!0)}(0,l,u),"data-id":u.id,"data-src":u.src,"data-album":u.album,"data-artist":u.artist,"data-format":u.format,"data-samplerate":u.sampleRate,"aria-label":`${(0,a.__)("Play song","kotisivu-block-theme")} ${l+1} ${(0,a.__)("of","kotisivu-block-theme")} ${e.length} ${(0,a.__)("in playlist","kotisivu-block-theme")}`,"aria-current":n.current===l?"true":"false",tabIndex:"0"},(0,t.createElement)("span",{className:"audio-player__list-item-text"},function(e){const t={"&#8211;":"-"};for(const a in t)if(e.indexOf(a)>=0)return e.replaceAll(a,t[a]);return e}(u.title)),u.featuredImage.src?(0,t.createElement)("img",{className:"audio-player__list-item-image",src:u.featuredImage.src,alt:u.featuredImage.alt,height:u.featuredImage.height,width:u.featuredImage.width}):(0,t.createElement)(m,null))}))))))};i()((async function(){(0,t.createRoot)(document.getElementById("audio-player")).render((0,t.createElement)(o,null))}))})();